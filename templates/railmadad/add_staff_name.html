{% extends 'railmadad/base.html' %}
{% load customrailmadad %}
{% block url_name %}Add Staff Name{% endblock %}
{% block url_title %}Data{% endblock %}
{% block breadcrum %}
    <li class="breadcrumb-item">
        <a href="/railmadad/show_staff_name/"> <i class="fa fa-home"></i></a>
    </li>
    <li class="breadcrumb-item">See The Data</li>
    <li class="breadcrumb-item">
        <a href="/railmadad/show_staff_name/">Show Staff Name</a>
    </li>
{% endblock %}
{% block title %}Add Staff Name{% endblock %}
{% block body %}
    <style>
  a:link,
  a:visited,
  a:hover,
  a:active {
    /* color: rgb(0, 0, 0); */
    text-decoration: none;
  }

  th a,
  td a {
    display: block;
    width: 100%;
  }

  th a.sort-by {
    padding-right: 18px;
    position: relative;
  }

  th a.sort-by:hover {
    color: rgb(0, 84, 87);
  }

  a.sort-by:before,
  a.sort-by:after {
    border: 4px solid transparent;
    content: '';
    display: block;
    height: 0;
    right: 5px;
    top: 50%;
    position: absolute;
    width: 0;
  }

  @media (max-width: 991px) {
    .responsive > thead th {
      display: none;
    }

    .responsive > tbody td,
    .responsive > tbody th {
      display: block;
    }

    .responsive > tbody > tr:nth-child(even) td,
    .responsive > tbody > tr:nth-child(even) th {
      background-color: #eee;
    }

    [row-header] {
      position: relative;
      width: 50%;
      vertical-align: middle;
    }

    [row-header]:before {
      content: attr(row-header);
      display: inline-block;
      vertical-align: middle;
      text-align: left;
      width: 50%;
      padding-right: 30px;
    }
  }
    </style>
    {% for message in messages %}
        <div id="alert" class="alert alert-{{ message.tags }}">{{ message }}</div>
        <script type="text/javascript">
  setTimeout(function () {
    $('#alert').alert('close');
  }, 4000);
        </script>
    {% endfor %}
    <form action="/railmadad/show_staff_name/" method="POST">
        {% csrf_token %}
        <center class="center">
            <h5>Filter Data:-</h5>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <br />
            {% if post %}
                <label for="start_date">
                    <u>
                        <h4>
                            <b>Enter Date For which you want to Add Staff Name</b>
                        </h4>
                    </u>
                </label>
                <br />
                <input required="true"
                       id="start-date"
                       type="date"
                       name="start_date"
                       value="{{ start_date }}" />
            {% else %}
                <label for="start_date">
                    <u>
                        <h4>
                            <b>Enter Date For which you want to Add Staff Name</b>
                        </h4>
                    </u>
                </label>
                <br />
                <input id="start-date" type="date" name="start_date" required="true" />
            {% endif %}
            <button type="submit" class="btn btn-danger my-2">Submit</button>
        </center>
    </form>
    {% if post %}
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th class="col" column="1">Sl No.</th>
                        <th class="col" column="2">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=reference&order={{ order }}"
                               class="sort-by">Reference Number</a>
                        </th>
                        <!-- <th class="col" column="3"><a href="/railmadad/show_staff_name?start_date={{start_date}}&sort_method=staff&order={{order}}" class="sort-by">Add Escort Staff</a></th> -->
                        <th class="col" column="4">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=train-number&order={{ order }}"
                               class="sort-by">Staff ID</a>
                        </th>
                        <th class="col" column="4">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=train-number&order={{ order }}"
                               class="sort-by">Staff First Name</a>
                        </th>
                        <th class="col" column="4">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=train-number&order={{ order }}"
                               class="sort-by">Staff Last Name</a>
                        </th>
                        <th class="col" column="4">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=train-number&order={{ order }}"
                               class="sort-by">Staff Departmentr</a>
                        </th>
                        <th class="col" column="4">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=train-number&order={{ order }}"
                               class="sort-by">Train Number</a>
                        </th>
                        <th class="col" column="5">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=type&order={{ order }}"
                               class="sort-by">Complain Type</a>
                        </th>
                        <th class="col" column="6">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=reg-date&order={{ order }}"
                               class="sort-by">Registration Date</a>
                        </th>
                        <th class="col" column="3">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=coach-number&order={{ order }}"
                               class="sort-by">Add Coach Number</a>
                        </th>
                        <th class="col" column="8">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=sub-type&order={{ order }}"
                               class="sort-by">Sub Type</a>
                        </th>
                        <th class="col" column="9">
                            <a href="/railmadad/show_staff_name?start_date={{ start_date }}&sort_method=rating&order={{ order }}"
                               class="sort-by">Rating</a>
                        </th>
                    </tr>
                </thead>
            {% else %}
            {% endif %}
            {% if post %}
                <form action="/railmadad/add_staff_name/" method="POST">
                    {% csrf_token %}
                    <tbody>
                        {% for complain in complains %}
                            <tr>
                                {% if complain.3|convertint in ref_number_staff %}
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <th scope="row">
                                        <p>{{ complain.3|convertint }}</p>
                                    </th>
                                    <th>
                                        <p>{{ values_staff|index:forloop.counter|index:1 }}</p>
                                    </th>
                                    <th>
                                        <p>{{ values_staff|index:forloop.counter|index:2 }}</p>
                                    </th>
                                    <th>
                                        <p>{{ values_staff|index:forloop.counter|index:3 }}</p>
                                    </th>
                                    <th>
                                        <p>{{ values_staff|index:forloop.counter|index:4 }}</p>
                                    </th>
                                    <th scope="row">{{ complain.8|convertint }}</th>
                                    <th scope="row">{{ complain.17 }}</th>
                                    <th scope="row">{{ complain.4 }}</th>
                                    {% if complain.12 == 0.0 %}
                                        <th scope="row">N/D</th>
                                    {% else %}
                                        <th scope="row">{{ complain.12|convertint }}</th>
                                    {% endif %}
                                    <th scope="row">{{ complain.18 }}</th>
                                    {% if complain.24 == 'nan' %}
                                        <th scope="row">Not Rated</th>
                                    {% else %}
                                        <th scope="row">{{ complain.24 }}</th>
                                    {% endif %}
                                {% else %}
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <th scope="row">
                                        <input name="ref_number"
                                               readonly="readonly"
                                               value="{{ complain.3|convertint }}" />
                                    </th>
                                    <!-- {% if complain.14 == "None" or complain.14 == "" or complain.14 == " " %}
                  <th scope="row"><input name="input-{{forloop.counter}}-{{complain.0}}" value=""></th>
                  {% else %}
                  <th scope="row"><input readonly="readonly" name="input-{{forloop.counter}}-{{complain.0}}" value="{{complain.14}}"></th>
{% endif %} -->
                                    <th>
                                        <input type="hidden" name="data_id" value="{{ complain.0|convertint }}" />
                                        <select name="staff_id"
                                                class="p-2"
                                                id="{{ forloop.counter }}"
                                                onchange="populate(this.value, this.id)">
                                            <option value="" disabled="true" selected="selected">select Id</option>
                                            {% for id in staff_ids %}<option value="{{ id }}">{{ id }}</option>{% endfor %}
                                        </select>
                                    </th>
                                    <th>
                                        <h6 id="fname{{ forloop.counter }}">N/A</h6>
                                        <input id="first_name{{ forloop.counter }}"
                                               type="hidden"
                                               name="fres"
                                               value="" />
                                    </th>
                                    <th>
                                        <h6 id="lname{{ forloop.counter }}">N/A</h6>
                                        <input id="last_name{{ forloop.counter }}"
                                               type="hidden"
                                               name="lres"
                                               value="" />
                                    </th>
                                    <th>
                                        <h6 id="dept{{ forloop.counter }}">N/A</h6>
                                        <input id="department{{ forloop.counter }}"
                                               type="hidden"
                                               name="dres"
                                               value="" />
                                    </th>
                                    <th scope="row">{{ complain.8|convertint }}</th>
                                    <th scope="row">{{ complain.17 }}</th>
                                    <th scope="row">{{ complain.4 }}</th>
                                    {% if complain.12 == 0.0 %}
                                        <th scope="row">N/D</th>
                                    {% else %}
                                        <th scope="row">{{ complain.12|convertint }}</th>
                                    {% endif %}
                                    <th scope="row">{{ complain.18 }}</th>
                                    {% if complain.24 == 'nan' %}
                                        <th scope="row">Not Rated</th>
                                    {% else %}
                                        <th scope="row">{{ complain.24 }}</th>
                                    {% endif %}
                                {% endif %}
                            </tr>
                        {% endfor %}
                    </tbody>
                    <input type="hidden"
                           readonly="readonly"
                           name="n_d"
                           value="{{ number_of_data }}" />
                    <button class="btn btn-success mx-3" type="submit">Update Staff Name</button>
                </form>
            {% else %}
            {% endif %}
        </table>
    </div>
    {% if order == 'asc' %}
        <style>
  a.sort-by:before {
    border-bottom-color: rgb(0, 0, 0);
    margin-top: -9px;
  }

  a.sort-by:after {
    border-top-color: #666;
    margin-top: 1px;
  }
        </style>
    {% elif order == 'desc' %}
        <style>
  a.sort-by:before {
    border-bottom-color: #666;
    margin-top: -9px;
  }

  a.sort-by:after {
    border-top-color: rgb(0, 0, 0);
    margin-top: 1px;
  }
        </style>
    {% else %}
        <style>
  a.sort-by:before {
    border-bottom-color: #666;
    margin-top: -9px;
  }

  a.sort-by:after {
    border-top-color: #666;
    margin-top: 1px;
  }
        </style>
    {% endif %}
    <script>
  var staff_json = JSON.parse('{{staff_json|safe}}');
  console.log(staff_json);
  function populate(value, id) {
    var fname = document.getElementById('fname' + id);
    var lname = document.getElementById('lname' + id);
    var dept = document.getElementById('dept' + id);
    var fnameIp = document.getElementById('first_name' + id);
    var lnameIp = document.getElementById('last_name' + id);
    var deptIp = document.getElementById('department' + id);
    fname.innerText = staff_json[`${value}`][1];
    lname.innerText = staff_json[`${value}`][2];
    dept.innerText = staff_json[`${value}`][3];
    fnameIp.setAttribute('value', staff_json[`${value}`][1]);
    lnameIp.setAttribute('value', staff_json[`${value}`][2]);
    deptIp.setAttribute('value', staff_json[`${value}`][3]);
  }
    </script>
{% endblock %}
